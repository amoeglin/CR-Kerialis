<!DOCTYPE html>
<html>
    <head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">   
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" />
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

		<script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

        <title>Analysis Report</title>

		<style>
			.container { width: 1920px !important; }
			hr {
			margin-top: 1rem;
			margin-bottom: 1rem;
			border: 0;
			border-top: 3px solid rgba(0, 0, 0, 0.1);
			}			
		</style>

		<script type="text/javascript">
			//https://www.codexworld.com/convert-html-to-pdf-using-javascript-jspdf/
			window.jsPDF = window.jspdf.jsPDF;

			function Convert_HTML_To_PDF() {
				var reportName = $('#reportName').val();
				var doc = new jsPDF({orientation: 'landscape'});				
				var elementHTML = document.querySelector("#contentToPrint");

				doc.html(elementHTML, {
					callback: function(doc) {
						doc.save(reportName);
					},
					margin: [10, 10, 10, 10],
					autoPaging: 'text',
					x: 0,
					y: 0,
					width:275, //target width in the PDF document
					windowWidth: 1700 //window width in CSS pixels
				});
			}

		</script>
    </head>
    <body>
        <div id="contentToPrint" class="mx-auto p-4 my-3 text-white text-center" style="background-color: #00a8bc; width:1700px">
			<input type="hidden" id="reportName" value="#ReportName">
            
			<div class="row">
				<div class="col-md-1 text-center"></div>
				<div class="col-md-10 text-center"><h1>Rapport d'analyse</h1></div>
				<div class="col-md-1 text-right">
					<button type="button" class="btn " onclick="Convert_HTML_To_PDF()"><img src="../pdf.png" width="70" /></button>
				</div>
			</div>    
			
            <p>#NameSize</p>

            <div class="mx-auto text-left p-4 my-3 text-secondary" style="background-color: #d0efee; width:1600px;">                
                <h2>Informations générales :</h2>
				<p>
				<div class="row">
                    <div class="col-sm">Groupe des données : #FileGroup</div>
                    <div class="col-sm">Type des données: #FileType</div>
                </div>
				<div class="row">
                    <div class="col-sm">Nombre de lignes dans la base de données : #NBRowsDB</div>
                    <div class="col-sm">nombre de lignes dans le fichier d'import : #NBRowsCSV</div>
                </div>
				<div class="row">
                    <div class="col-sm">#ValueDB</div>
                    <div class="col-sm">#ValueCSV</div>
                </div>				
				</p>
				<div class="row text-danger" style="">
                    <div class="col-sm"><i><b>Différence nb des lignes entre la base et le fichier d'import : #DiffRows</b></i></div>
                    <div class="col-sm"><i><b>#DiffValue</b></i></div>
                </div>				
            </div>

			<div class="mx-auto text-left p-4 my-3 text-secondary" style="background-color: #d0efee; width:1600px;">                
                <h2 class="mb-3" >Lignes manquantes ou différentes :</h2>
				<h5 class="mb-3" style="width:100%; background-color: bisque;">Lignes trouvées dans la base, manquantes dans le fichier d'import :</h5>
				<div>
					<div class="table-responsive">
					#MissingCSVRows
					</div>
				</div>

					<!-- <i><b>Id of row in database: </b></i>133<br>
					<i><b>SQL: </b></i>SELECT * FROM Cotisations WHERE Id = 133 <br>
					<i><b>Data: </b></i>133	12	KERIALIS_ENTREPRISE	SUR MESURE	47500207	4750020 <br><br> -->
					
					<!-- <b>Potentially corresponding row in import file:</b><br>
					<i><b>Line number: </b></i>25 <br>
					<i><b>Data: </b></i>133	12	KERIALIS_ENTREPRISE	SUR MESURE	47500207	47500207... <br><br> -->
				
					<!-- <hr> -->
				
				<hr style="margin-bottom: 30px; border-top: 4px solid #0099B1;">

				<h5 class="mb-3" style="width:100%; background-color: bisque;">Lignes trouvées dans le fichier d'import, manquantes dans la base :</h5>
				<div>
					<div class="table-responsive">
					#MissingDBRows
					</div>
				</div>

					<!-- <p>
					<i><b>Line number: </b></i>133<br>					
					<i><b>Data: </b></i>133	12	KERIALIS_ENTREPRISE	SUR MESURE	261717,72 <br><br>
					<b>Potentially corresponding row in DB:</b><br>
					<i><b>Id of row in database: </b></i>25 <br>
					<i><b>SQL: </b></i>SELECT * FROM Cotisations WHERE Id = 133 <br>
					<i><b>Data: </b></i>133	12	KERIALIS_ENTREPRISE	SUR MESURE	261717,72 <br><br>
					</p>
					<hr> -->
				
			</div>
        </div>
    </body>
</html>
